server {
    listen 8080;
    server_name localhost;
    
    # Comprimi le risposte
    gzip on;
    gzip_types text/plain text/css application/json application/javascript text/xml application/xml application/xml+rss text/javascript;
    
    # Redirect completo per tutte le richieste fbasaving verso il backend Django originale su Railway
    location ~ ^/(fbasaving|en/fbasaving|it/fbasaving)($|/) {
        # Redirect 307 (temporaneo) al backend Django su Railway
        return 307 https://prep-center-production.up.railway.app$request_uri;
    }
    
    # Servi file statici dalla cartella build
    location / {
        root /app/build;
        try_files $uri $uri/ /index.html;
    }
    
    # Gestisci le rotte di picture_check con l'app React
    location ~ ^/(picture_check|en/picture_check|it/picture_check)/ {
        root /app/build;
        try_files $uri $uri/ /index.html;
    }
} 